import "dart:json" as AK;import "dart:math" as jB;import "dart:async" as bB;import "dart:indexed_db" as SF;import "dart:mirrors" as BK;import "dart:typed_data" as CK;import "dart:web_sql" as TH;import "dart:html" as wB;import "dart:web_audio" as yD;class DK{static const  EK="Chrome";static const  FK="Firefox";static const  GK="Internet Explorer";static const  HK="Safari";final  tI;final  minimumVersion;const DK(this.tI,[this.minimumVersion]);}class IK{}class JK{final  name;const JK(this.name);}class KK{}class LK{}var TF={"asteroid-0-0.png":{"frame":{"x":106,"y":810,"w":98,"h":100},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":17,"w":98,"h":100},"sourceSize":{"w":128,"h":128}},"asteroid-0-1.png":{"frame":{"x":369,"y":754,"w":94,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":18,"y":10,"w":94,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-10.png":{"frame":{"x":479,"y":212,"w":114,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":11,"y":11,"w":114,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-11.png":{"frame":{"x":597,"y":100,"w":114,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":8,"w":114,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-12.png":{"frame":{"x":220,"y":696,"w":108,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":12,"w":108,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-13.png":{"frame":{"x":334,"y":586,"w":108,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":12,"w":108,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-14.png":{"frame":{"x":580,"y":510,"w":110,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":10,"w":110,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-15.png":{"frame":{"x":662,"y":634,"w":106,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":9,"w":106,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-16.png":{"frame":{"x":0,"y":698,"w":108,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":7,"w":108,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-17.png":{"frame":{"x":363,"y":100,"w":118,"h":92},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":19,"w":118,"h":92},"sourceSize":{"w":128,"h":128}},"asteroid-0-18.png":{"frame":{"x":245,"y":196,"w":116,"h":90},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":20,"w":116,"h":90},"sourceSize":{"w":128,"h":128}},"asteroid-0-19.png":{"frame":{"x":228,"y":286,"w":114,"h":98},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":16,"w":114,"h":98},"sourceSize":{"w":128,"h":128}},"asteroid-0-2.png":{"frame":{"x":208,"y":902,"w":94,"h":116},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":18,"y":12,"w":94,"h":116},"sourceSize":{"w":128,"h":128}},"asteroid-0-20.png":{"frame":{"x":921,"y":114,"w":102,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":6,"w":102,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-21.png":{"frame":{"x":394,"y":868,"w":94,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":4,"w":94,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-22.png":{"frame":{"x":768,"y":656,"w":96,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":11,"y":7,"w":96,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-23.png":{"frame":{"x":108,"y":706,"w":108,"h":104},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":11,"w":108,"h":104},"sourceSize":{"w":128,"h":128}},"asteroid-0-24.png":{"frame":{"x":707,"y":320,"w":114,"h":98},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":7,"y":13,"w":114,"h":98},"sourceSize":{"w":128,"h":128}},"asteroid-0-25.png":{"frame":{"x":593,"y":316,"w":114,"h":102},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":14,"w":114,"h":102},"sourceSize":{"w":128,"h":128}},"asteroid-0-26.png":{"frame":{"x":226,"y":384,"w":112,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":12,"w":112,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-27.png":{"frame":{"x":114,"y":264,"w":114,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":5,"w":114,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-28.png":{"frame":{"x":910,"y":564,"w":110,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":7,"w":110,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-29.png":{"frame":{"x":361,"y":284,"w":114,"h":108},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":3,"y":6,"w":114,"h":108},"sourceSize":{"w":128,"h":128}},"asteroid-0-3.png":{"frame":{"x":921,"y":452,"w":98,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":15,"y":8,"w":98,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-30.png":{"frame":{"x":711,"y":210,"w":114,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":4,"w":114,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-31.png":{"frame":{"x":800,"y":550,"w":110,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":4,"w":110,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-32.png":{"frame":{"x":442,"y":648,"w":106,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":6,"w":106,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-33.png":{"frame":{"x":825,"y":214,"w":96,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":15,"y":1,"w":96,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-34.png":{"frame":{"x":302,"y":884,"w":92,"h":116},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":17,"y":0,"w":92,"h":116},"sourceSize":{"w":128,"h":128}},"asteroid-0-35.png":{"frame":{"x":821,"y":328,"w":100,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":13,"y":4,"w":100,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-36.png":{"frame":{"x":0,"y":494,"w":112,"h":104},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":8,"w":112,"h":104},"sourceSize":{"w":128,"h":128}},"asteroid-0-37.png":{"frame":{"x":358,"y":392,"w":112,"h":96},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":10,"w":112,"h":96},"sourceSize":{"w":128,"h":128}},"asteroid-0-38.png":{"frame":{"x":338,"y":488,"w":110,"h":98},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":10,"w":110,"h":98},"sourceSize":{"w":128,"h":128}},"asteroid-0-39.png":{"frame":{"x":224,"y":588,"w":108,"h":108},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":8,"w":108,"h":108},"sourceSize":{"w":128,"h":128}},"asteroid-0-4.png":{"frame":{"x":0,"y":598,"w":112,"h":100},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":16,"w":112,"h":100},"sourceSize":{"w":128,"h":128}},"asteroid-0-40.png":{"frame":{"x":921,"y":224,"w":100,"h":116},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":15,"y":6,"w":100,"h":116},"sourceSize":{"w":128,"h":128}},"asteroid-0-41.png":{"frame":{"x":104,"y":912,"w":104,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":10,"y":5,"w":104,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-42.png":{"frame":{"x":0,"y":380,"w":112,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":4,"y":3,"w":112,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-43.png":{"frame":{"x":481,"y":100,"w":116,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":5,"w":116,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-44.png":{"frame":{"x":811,"y":440,"w":110,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":11,"y":6,"w":110,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-45.png":{"frame":{"x":448,"y":534,"w":108,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":2,"w":108,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-46.png":{"frame":{"x":470,"y":422,"w":110,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":5,"w":110,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-47.png":{"frame":{"x":0,"y":804,"w":106,"h":108},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":17,"y":9,"w":106,"h":108},"sourceSize":{"w":128,"h":128}},"asteroid-0-48.png":{"frame":{"x":112,"y":600,"w":108,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":14,"w":108,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-49.png":{"frame":{"x":245,"y":100,"w":118,"h":96},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":15,"w":118,"h":96},"sourceSize":{"w":128,"h":128}},"asteroid-0-5.png":{"frame":{"x":589,"y":418,"w":112,"h":92},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":5,"y":23,"w":112,"h":92},"sourceSize":{"w":128,"h":128}},"asteroid-0-50.png":{"frame":{"x":363,"y":192,"w":116,"h":92},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":17,"w":116,"h":92},"sourceSize":{"w":128,"h":128}},"asteroid-0-51.png":{"frame":{"x":800,"y":0,"w":122,"h":100},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":14,"w":122,"h":100},"sourceSize":{"w":128,"h":128}},"asteroid-0-52.png":{"frame":{"x":922,"y":0,"w":102,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":16,"y":9,"w":102,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-53.png":{"frame":{"x":825,"y":100,"w":96,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":21,"y":11,"w":96,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-54.png":{"frame":{"x":652,"y":740,"w":96,"h":108},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":21,"y":10,"w":96,"h":108},"sourceSize":{"w":128,"h":128}},"asteroid-0-55.png":{"frame":{"x":556,"y":620,"w":106,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":11,"w":106,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-56.png":{"frame":{"x":475,"y":322,"w":114,"h":100},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":6,"y":15,"w":114,"h":100},"sourceSize":{"w":128,"h":128}},"asteroid-0-57.png":{"frame":{"x":593,"y":212,"w":114,"h":104},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":10,"w":114,"h":104},"sourceSize":{"w":128,"h":128}},"asteroid-0-58.png":{"frame":{"x":114,"y":378,"w":112,"h":114},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":11,"y":2,"w":112,"h":114},"sourceSize":{"w":128,"h":128}},"asteroid-0-59.png":{"frame":{"x":0,"y":264,"w":114,"h":116},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":6,"w":114,"h":116},"sourceSize":{"w":128,"h":128}},"asteroid-0-6.png":{"frame":{"x":224,"y":494,"w":110,"h":94},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":8,"y":21,"w":110,"h":94},"sourceSize":{"w":128,"h":128}},"asteroid-0-60.png":{"frame":{"x":701,"y":418,"w":110,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":11,"y":11,"w":110,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-61.png":{"frame":{"x":112,"y":492,"w":112,"h":108},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":14,"w":112,"h":108},"sourceSize":{"w":128,"h":128}},"asteroid-0-62.png":{"frame":{"x":711,"y":100,"w":114,"h":110},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":9,"y":13,"w":114,"h":110},"sourceSize":{"w":128,"h":128}},"asteroid-0-63.png":{"frame":{"x":690,"y":528,"w":110,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":8,"y":17,"w":110,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-7.png":{"frame":{"x":548,"y":726,"w":104,"h":106},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":12,"y":11,"w":104,"h":106},"sourceSize":{"w":128,"h":128}},"asteroid-0-8.png":{"frame":{"x":921,"y":340,"w":98,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":13,"y":6,"w":98,"h":112},"sourceSize":{"w":128,"h":128}},"asteroid-0-9.png":{"frame":{"x":0,"y":912,"w":104,"h":112},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":14,"y":8,"w":104,"h":112},"sourceSize":{"w":128,"h":128}},"bullet_dummy.png":{"frame":{"x":228,"y":264,"w":4,"h":4},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":4,"h":4},"sourceSize":{"w":4,"h":4}},"hud_dummy.png":{"frame":{"x":0,"y":0,"w":800,"h":100},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":800,"h":100},"sourceSize":{"w":800,"h":100}},"spaceship.png":{"frame":{"x":0,"y":100,"w":245,"h":164},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":245,"h":164},"sourceSize":{"w":245,"h":164}},"spaceship_thrusters.png":{"frame":{"x":296,"y":802,"w":73,"h":82},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":0,"y":41,"w":73,"h":82},"sourceSize":{"w":367,"h":164}},"star_00.png":{"frame":{"x":204,"y":810,"w":92,"h":92},"rotated":false,"trimmed":true,"spriteSourceSize":{"x":18,"y":18,"w":92,"h":92},"sourceSize":{"w":128,"h":128}},"upgrade_bullet_amount.png":{"frame":{"x":338,"y":464,"w":20,"h":20},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":20},"sourceSize":{"w":20,"h":20}},"upgrade_bullet_strength.png":{"frame":{"x":338,"y":444,"w":20,"h":20},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":20},"sourceSize":{"w":20,"h":20}},"upgrade_health.png":{"frame":{"x":338,"y":424,"w":20,"h":20},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":20},"sourceSize":{"w":20,"h":20}},"upgrade_hyperdrive.png":{"frame":{"x":338,"y":404,"w":20,"h":20},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":20},"sourceSize":{"w":20,"h":20}},"upgrade_thruster.png":{"frame":{"x":338,"y":384,"w":20,"h":20},"rotated":false,"trimmed":false,"spriteSourceSize":{"x":0,"y":0,"w":20,"h":20},"sourceSize":{"w":20,"h":20}}}; main(){VH();var w=UH();var g=wB.query('#gamecontainer');var i=wB.query('#hudcontainer');var m=new Map<String,vC>();TF.forEach((k,AB){m[k]=new vC(TF[k]);});wB.window.setImmediate((){g.width=EB;g.height=PB;i.width=EB;i.height=iI;bB.Future.wait(w).then((p){i.context2D..textBaseline='top'..font='20px D3Radicalism';var q=new YD(p[0],m);g.focus();var h=new WH(g,i,q);g.onBlur.listen((j)=>h.pause());g.onFocus.listen((j)=>h.unpause());g.onKeyDown.listen((j){if(j.keyCode==wB.KeyCode.P){if(DB.paused){h.unpause();}else{h.pause();}}});h.start();});});} UH(){var i=['game_assets.png'];var g=new bB.Completer<wB.ImageElement>();var h=new List<bB.Future>();i.forEach((j){var g=new bB.Completer();h.add(g.future);dI.eI(j,(k){g.complete(k);});});return h;} VH(){var i={'tabStory':'story','tabControls':'controls','tabCredits':'credits','tabDebug':'debug'};var g='tabStory';i.forEach((h,k){var j=wB.query('#${h}');var m=wB.query('#${k}');j.onClick.listen((p){if(h!=g){j.classes.add('selectedTab');m.classes.remove('hidden');wB.query('#${g}').classes.remove('selectedTab');wB.query('#${i[g]}').classes.add('hidden');g=h;}});});}class WH{var fD;var WG;var fB;var PD;var uE;var DF;var bG=0;var TC;var cD;var SD;var oG;var CF;var RD;var pG;var qG;var EF;WH(this.fD,this.WG,this.fB){PD=fD.context2D;uE=WG.context2D;cD=WI(wB.window.location.href);EF=0.5;} start(){TC=new eB();SD=new RB();oG=new LB(100*EF);CF=new oB();RD=new sB();pG=new QB();qG=new KC();HG(TC,0);TC.UC=16;TC.process();QG(16);} pause(){DB.paused=true;if(wB.document.activeElement!=fD){DF.jJ();}} unpause(){DB.paused=false;} QG( g){TC.UC=g-bG;bG=g;TC.process();if(!DB.paused){if(RD.OB&&!RD.TD&&!DB.zE){hJ();}}wB.window.animationFrame.then(QG);} HG( g, AB){var k=jB.pow(1.2,AB);DB.dG=k;var m=new fE();var j=new DC();g.FE(j);g.FE(m);var p=KB/2;var q=JB/2;var w=45*EF;var h=g.iC();h.v(new t(p,q,angle:-jB.PI/2));h.v(new BB(0.0,0.0));h.v(new cB('spaceship.png',scale:0.25));h.v(new NB(w));h.v(new wC('#1fe9f6'));h.v(new gC(-10,-10));h.v(SD);h.v(oG);h.v(CF);h.v(RD);h.v(pG);h.v(qG);h.hC();var i=g.iC();i.v(new FB());i.hC();rI(g,m);pI(g,p,q,w,k);sI(g);j.register(i,IC);j.register(h,dC);DF=new EI(fD);g.SB(DF);g.SB(new fK());g.SB(new dK());g.SB(new eK());g.SB(new gK());g.SB(new iK());g.SB(new jK());g.SB(new kK());g.SB(new mK());g.SB(new nK());g.SB(new cK());g.SB(new lK());g.SB(new hK());g.SB(new bI(PD));g.SB(new XK(PD));g.SB(new YK(PD,fB));g.SB(new TK(PD,fB));g.SB(new ZK(PD));g.SB(new bK(uE));g.SB(new aK(uE,fB));g.SB(new SK(cD));g.SB(new MK());g.SB(new UK(fD));g.SB(new RK(DB));g.initialize();} rI( i, j){for(int h=0;h<jB.sqrt(KB*JB)/5;h++ ){var g=i.iC();g.v(new t(YB.nextDouble()*KB,YB.nextDouble()*JB));g.hC();j.add(g,qF);}} pI( AB, IB, WB, w, j){for(int h=0;h<jB.sqrt(KB*JB)/100;h++ ){var i=JC(0.2,0.5);var g=AB.iC();var m=YB.nextDouble()*KB;var k=YB.nextDouble()*JB;var q=50*i;while (aE.hE(IB,WB,w*3,m,k,q)){m=YB.nextDouble()*KB;k=YB.nextDouble()*JB;}g.v(new t(m,k,angle:YB.nextDouble()*MB.MC,rotationRate:JC(0.15,0.20)));g.v(rF(0.025*j,0.1*j));var p=new List<String>(64);for(int h=0;h<64;h++ ){p[h]='asteroid-0-${h}.png';}g.v(new cB.EL(p,scale:i));g.v(new NB(q));g.v(new LB(100*i*j));g.v(new wC('#333'));g.v(new RB(maxHealth:100*i*j));g.v(new xC(JC(2,4).round().toInt()));g.v(new gC(10*i,100*i*j));g.hC();}} sI( g){for(int h=0;h<4;h++ ){aD(g,new eC('health',healthGain:5,fillHealth:true,massGain:1));}for(int h=0;h<jB.min(1,jE-CF.SC);h++ ){aD(g,new eC('bullet_amount',bullets:1,massGain:5));}aD(g,new eC('bullet_strength',bulletDamageGain:0.5,massGain:1));if(!RD.enabled){aD(g,new eC('hyperdrive',enableHyperDrive:true,massGain:10));}aD(g,new eC('thruster',thrustGain:0.00004,massGain:1));} aD( j, i){var h=1.0;var g=j.iC();g.v(new t(YB.nextDouble()*KB,YB.nextDouble()*JB));g.v(rF(0.025,0.1));g.v(new cB('upgrade_${i.name}.png',scale:h));g.v(new NB(10*h));g.v(new LB(20*h));g.v(new wC('#00FF00'));g.v(i);g.hC();} hJ(){DB.zE=true;var h=TC.zB(new DC().runtimeType);var g=h.gB(dC);g.v(new RC(angle:MB.jH,velocity:0.7));g.LE();var j=CJ(DB.ME+1);j.then((i){if(!SD.jC){TC=i;h=TC.zB(new DC().runtimeType);g=h.gB(dC);g.GF(RC);g.LE();RD.TD=true;DB.zE=false;DB.ME++ ;}});} CJ( h){var g=new bB.Completer<eB>();qE(g,h);return g.future;} qE( i, h,[ g=0]){if(DB.paused){new bB.Timer(new Duration(milliseconds:500),(){qE(i,h,g);});}else{if(g<8000){new bB.Timer(new Duration(milliseconds:500),(){qE(i,h,g+500);});}else{var j=new eB();HG(j,h);i.complete(j);}}}}class MK extends ID{var JJ=wB.query('#fps');var fJ=wB.query('#playerPos');var uI=wB.query('#cameraPos');var FJ=wB.query('#entityCount');var rJ=wB.query('#playerThrust');var lB;var mD;var pB;var sD;var aB; initialize(){lB=new u<FB>(FB,o);mD=new u<t>(t,o);sD=new u<QB>(QB,o);pB=new u<LB>(LB,o);aB=o.zB(new DC().runtimeType);} BC(){var m=aB.gB(IC);var g=aB.gB(dC);var i=lB.get(m);var j=mD.get(g);var h=sD.get(g);var k=pB.get(g);var p=1000~/o.UC;JJ.text='${p}';uI.text='x: ${i.x}; y: ${i.y}';fJ.text='x: ${j.x}; y: ${j.y}';rJ.text='Thrust: ${h.rD}; Mass: ${k.value}; q: ${100*jB.sqrt(h.rD/k.value)}m/s^2';FJ.text='${o.MG.oI}';}} YE( g, h, i)=>g<h?h:g>i?i:g;class UD{static final  YH=wB.window.navigator.userAgent.contains(r'Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone');static  aH( g){var h=new wB.CanvasElement(width:g.width,height:g.height);h.context2D.drawImage(g,0,0);return h;}static  ZE( g){var m=0,i=0,q=0,j=0,p=0,k=0;var h=g.currentTarget;do{m+= h.offset.left;i+= h.offset.top;}while(null!=(h=h.offsetParent));if(null!=g.page.x||null!=g.page.y){p=g.page.x;k=g.page.y;}q=p-m;j=k-i;return new wB.Point(q,j);}}class XH{final  GG;XH.uK(this.GG); get GL=>GG.canvas; HL( g)=>UD.ZE(g); get IL=>UD.YH; get onMouseMove{var g;if(IL){g=GL.onTouchMove;}else{g=GL.onMouseMove;}return g.map((h)=>HL(h));} get onMouseDown{var i=new bB.StreamController<bH>();var h;if(IL){h=GL.onTouchStart;}else{h=GL.onMouseDown;}h.listen((g){g.preventDefault();i.add(new bH(HL(g),g.button));});return i.stream;} get onKeyDown=>wB.document.onKeyDown.map((g)=>g.keyCode); get onKeyUp=>wB.document.onKeyUp.map((g)=>g.keyCode);} UF([var g, i]){var h;if(null==g||g is int){var j=(g!=null?g:wB.window.innerWidth);i=(i!=null?i:wB.window.innerHeight);h=new wB.CanvasElement(width:j,height:i);}else if(g is String){h=wB.query(g);}else if(g is wB.ImageElement){h=UD.aH(g);}else if(g is zD){return g;}else{h=g;}return new zD(h);}class zD implements wB.CanvasRenderingContext2D{static final  ZH=new RegExp((r'\s+'));var GL;var JL;var KL; get canvas=>GL; get context2D=>JL;zD(this.GL){JL=GL.context2D;KL=new XH.uK(this);} noSuchMethod( g)=>BK.reflect(JL).delegate(g); oJ({ strokeStyle, fillStyle}){if(null!=strokeStyle){var g=JL.strokeStyle;JL..strokeStyle=strokeStyle..stroke()..strokeStyle=g;}if(null!=fillStyle){var g=JL.fillStyle;JL..fillStyle=fillStyle..fill()..fillStyle=g;}} DJ( m, j, g, h){var i=new wB.CanvasElement(width:g,height:h);var k=i.context2D;k.drawImageScaledFromSource(GL,m,j,g,h,0,0,g,h);GL.width=g;GL.height=h;clear();JL.drawImage(i,0,0);} trim({ color}){var m;var q;var p;if(color!=null){q=new NK.vK(color).sJ();m=q[4]==255?true:false;}else m=true;var w=JL.getImageData(0,0,GL.width,GL.height);var i=w.data;var g=[GL.width,GL.height,0,0];for(var h=0,AB=i.length;h<AB;h+= 4){if(m){if(i[h+3]==0)continue;}else if(i[h+0]==color[0]&&i[h+1]==color[1]&&i[h+2]==color[2])continue;var j=(h~/4)%GL.width;var k=(h~/4)~/GL.width;if(j<g[0])g[0]=j;if(j>g[2])g[2]=j;if(k<g[1])g[1]=k;if(k>g[3])g[3]=k;}if(g[2]==0||g[3]==0){}else{p=new wB.Rect(g[0],g[1],g[2]-g[0],g[3]-g[1]);DJ(g[0],g[1],g[2]-g[0]+1,g[3]-g[1]+1);}return p;} clear({ color}){if(null!=color){JL.fillStyle=color;JL.fillRect(0,0,GL.width,GL.height);}else{JL.clearRect(0,0,GL.width,GL.height);}} copy(){var g=new wB.CanvasElement(width:GL.width,height:GL.height);g.context2D.drawImage(GL,0,0);return g;} nJ({ hue, saturation, lightness}){var q=null==hue?null:hue.toDouble();var IB=null==saturation?null:saturation.toDouble();var k=null==lightness?null:lightness.toDouble();var m=JL.getImageData(0,0,GL.width,GL.height);var h=m.data;var AB,p,w;var j;var i;for(var g=0,WB=h.length;g<WB;g+= 4){j=dH(h[g+0],h[g+1],h[g+2]);AB=q==null?j[0]:YE(q,0,1);p=IB==null?j[1]:YE(IB,0,1);w=k==null?j[2]:YE(k,0,1);i=eH(AB,p,w);h[g+0]=i[0];h[g+1]=i[1];h[g+2]=i[2];}JL.putImageData(m,0,0);} uG( h, g, j, k, i,{ strokeStyle, fillStyle}){JL..beginPath()..moveTo(h+i,g)..lineTo(h+j-i,g)..quadraticCurveTo(h+j,g,h+j,g+i)..lineTo(h+j,g+k-i)..quadraticCurveTo(h+j,g+k,h+j-i,g+k)..lineTo(h+i,g+k)..quadraticCurveTo(h,g+k,h,g+k-i)..lineTo(h,g+i)..quadraticCurveTo(h,g,h+i,g)..closePath();oJ(strokeStyle:strokeStyle,fillStyle:fillStyle);} OJ( IB, q, w, j,[ AB]){var tB=new RegExp(r"(\d+)");var p=int.parse(tB.firstMatch(font).group(0))*2;var m=SG(IB,AB);var WB=JL.fillStyle;for(var h=0;h<m.length;h++ ){var i=(w+h*p*0.6).toInt();var k=JL.createLinearGradient(0,i,0,(i+p*0.6).toInt());for(var g=0;g<j.length;g+= 2){k.addColorStop(j[g],j[g+1]);}JL..fillStyle=k..fillText(m[h],q,i);}JL.fillStyle=WB;} qJ( h,[ g]){var j=new RegExp(r"(\d+)");var i=int.parse(j.firstMatch(font).group(0))*2;var k=SG(h,g);if(null==g){g=JL.measureText(h).width;}return new wB.Rect(0,0,g,(k.length*i*0.6).toInt());} SG( q,[ i]){var p=q.split(ZH);var j=0;var IB=0;var g=new List<String>.from([""]);var AB=JL.measureText(" ").width;if(null!=i){i+= AB;var k=0;for(var h=0;h<p.length;h++ ){var w="${p[h]} ";var m=JL.measureText(w).width;if(j+m>i){g.add("");k++ ;j=0;}g[k]="${g[k]}${w}";j+= m;}}else{g=[q];}return g;}}class bH{final  position;final  button;bH(this.position,this.button);}class NK{var r,PG,b,a;NK.vK( h,[this.a=255]){var g=cH(h);r=g[0];PG=g[1];b=g[2];} sJ()=>[r,PG,b,a];} cH( g){return [int.parse('0x${g[1]}${g[2]}'),int.parse('0x${g[3]}${g[4]}'),int.parse('0x${g[5]}${g[6]}')];} dH( m, h, i){var g=jB.max(jB.max(m,h),i),k=jB.min(jB.min(m,h),i);var j,q,w=(g+k)/(2*255);if(g==k){j=q=0.0;}else{var p=g-k;q=w>0.5?p/(2*255-g-k):p/(g+k);if(g==m){j=(h-i)/p+(h<i?6:0);}else if(g==h){j=(i-m)/p+2;}else if(g==i){j=(m-h)/p+4;}j/= 6.0;}return [j,q,w];} eH( WB, IB, tB){var p=WB.toDouble();var k=IB.toDouble();var j=tB.toDouble();var m;var q;var w;if(k==0.0){m=q=w=j;}else{var AB=( h, i, g){if(g<0)g+= 1;if(g>1)g-= 1;if(g<1/6)return h+(i-h)*6*g;if(g<1/2)return i;if(g<2/3)return h+(i-h)*(2/3-g)*6;return h;};var i=j<0.5?j*(1+k):j+k-j*k;var h=2*j-i;m=AB(h,i,p+1/3);q=AB(h,i,p);w=AB(h,i,p-1/3);}return [(m*255+0.5).toInt(),(q*255+0.5).toInt(),(w*255+0.5).toInt()];}class VD{static var XF=new Map<Type,ZC>();static  WD( h){var g=XF[h];if(g==null){g=new ZC();XF[h]=g;}return g;}static  kH( g)=>WD(g).IE;}class fH{static var WF=0;static var AE;static  hH( h){if(null==AE){AE=new Map<Type,int>();}var g=AE[h];if(g==null){g=1<<WF;WF++ ;AE[h]=g;}return g;}}class aE{static  hE( q, j, k, m, w, p){var g=m-q;var i=w-j;var h=k+p;return (g*g+i*i)<(h*h);}}abstract class VF{ GE( g); pE( g); BD( g); enabled( g); disabled( g);}class cE extends aC{var ML;var QL;cE():ML=new CB<CB<qB>>(),QL=new CB<l>(); initialize(){} dL( g){hL(g,(h,i){h[g.id].gL();h[g.id]=null;});g.oL=0;} tL( i, j, k){var h=j.id;ML.zL(h);var g=ML[h];if(g==null){g=new CB<qB>();ML[h]=g;}g[i.id]=k;i.EM(j.IE);} FM( g, h){if((g.oL&h.IE)!=0){var i=h.id;ML[i][g.id].gL();ML[i][g.id]=null;g.HM(h.IE);}} MJ( i){var h=i.id;ML.zL(h);var g=ML[h];if(g==null){g=new CB<qB>();ML[h]=g;}return g;} MM( h, j){var i=j.id;var g=ML[i];if(g!=null&&g.XG(h.id)){return g[h.id];}return null;} hL( i, j( components, index)){var g=i.oL;var h=0;while (g>0){if((g&1)==1){j(ML[h],h);}h++ ;g=g>>1;}} BD( g)=>QL.add(g); AJ(){QL.forEach((g)=>dL(g));QL.clear();}}class ZC{static var dE=1;static var gH=0;var PL=0;var RL=0;ZC(){PL=dE;dE=dE<<1;RL=gH++ ;} get IE=>PL; get id=>RL;}class bE extends aC{var LL;var NL;var TL;var UL=0;var VL=0;var WL=0;var QL=0;var bL;bE():LL=new CB<l>(),NL=new CB<l>(),TL=new CB<bool>(),bL=new tH(); initialize(){} wL(){var g=NL.removeLast();if(null==g){g=new l.xK(OL,bL.zI());}WL++ ;return g;} GE( g){UL++ ;VL++ ;LL[g.id]=g;} enabled( g){TL[g.id]=false;} disabled( g){TL[g.id]=true;} BD( g){LL[g.id]=null;TL[g.id]=false;NL.add(g);UL-- ;QL++ ;} isActive( g)=>LL[g]!=null; LM( g)=>LL[g]; get oI=>UL;}abstract class aC implements VF{var OL; initialize(); GE( g){} pE( g){} BD( g){} disabled( g){} enabled( g){}}class CC<xB>{var SL;CC.wK(this.SL); operator[]( g)=>SL[g]; get size=>SL.size; get isEmpty=>SL.isEmpty; contains( g)=>SL.contains(g); forEach( g( element))=>SL.forEach(g);}class MB{static const  YF=jB.PI;static const  iH=0.5*YF;static const  MC=2.0*YF;static const  jH=MC-iH;static  tC(final  g)=>aF.tC(g);static  NC( g)=>aF.NC(g);}class l{final  id;var mL=0;var oL=0;var AE=0;var OL;var fL;var kL;l.xK(this.OL,this.id){fL=OL.MG;kL=OL.EG;} EM( g){oL|= g;} HM( g){oL&= ~g;} IM( g){AE|= g;} JM( g){AE&= ~g;} toString()=>"Entity[${id}]"; v( g){kL.tL(this,VD.WD(g.runtimeType),g);} GF( g){kL.FM(this,VD.WD(g));} get OB=>fL.isActive(id); KJ( g){return kL.MM(this,g);} LJ( g){return KJ(VD.WD(g));} hC()=>OL.qI(this); eD()=>OL.EJ(this); LE()=>OL.yI(this);}abstract class sC extends bC{sC( g):super(g); nC( g); nD( h)=>h.forEach((g)=>nC(g)); ZB()=>true;}class u<BE extends qB>{var ZL;var cL;u( h, g){this.ZL=VD.WD(h);cL=g.EG.MJ(this.ZL);}BE get( g)=>cL[g.id] as BE; AC( g){if(cL.XG(g.id)){return cL[g.id] as BE;}return null;}}class CB<xB>{var XL;var YL=0;var aL;CB({ capacity: 16}):XL=new List(capacity){aL=new CC.wK(this);} operator[]( g)=>XL[g]; get size=>YL; get readOnly=>aL; get isEmpty=>YL==0; forEach( h( element)){for(int g=0;g<YL;g++ ){h(XL[g]);}} removeLast(){if(YL>0){var g=XL[ --YL];XL[YL]=null;return g;}return null;} remove( i){for(int g=0;g<YL;g++ ){var h=XL[g];if(i==h){XL[g]=XL[ --YL];XL[YL]=null;return true;}}return false;} contains( h){for(int g=0;YL>g;g++ ){if(h==XL[g]){return true;}}return false;} get xI=>XL.length; add( g){if(YL==XL.length){TM();}XL[YL++ ]=g;} operator[]=( g, h){if(g>=XL.length){UM(g*2);}if(YL<=g){YL=g+1;}XL[g]=h;} TM(){var g=((XL.length*3)/2+1).toInt();UM(g);} UM( h){var g=XL;XL=new List<xB>(h);XL.setRange(0,g.length,g);} zL( g){if(g>=XL.length){UM(g*2);}} clear(){for(int g=0;g<YL;g++ ){XL[g]=null;}YL=0;} addAll( h){for(int g=0;h.size>g;g++ ){add(h[g]);}} XG( g)=>g<xI; toString()=>"[${XL.join(',')}]";}abstract class qB{ gL(){}}class ZF{static var eE=new Map<Type,CB<uC>>();static uC lH( i, j){var h=mH(i);var g=h.removeLast();if(null==g){g=j();}return g;}static  mH( h){var g=eE[h];if(null==g){g=new CB();eE[h]=g;}return g;}static  oH( g){eE[g.runtimeType].add(g);}}class DC extends aC{final  eL;final  iL;DC():eL=new Map<String,l>(),iL=new Map<l,String>(); register( g, h){eL[h]=g;iL[g]=h;} unregister( g){iL.remove(eL.remove(g));} gB( g)=>eL[g]; BD( h){var g=iL.remove(h);if(g!=null){eL.remove(g);}} initialize(){}}abstract class ID extends bC{ID():super(VB.uH()); nD( g)=>BC(); BC(); ZB()=>true;}class eB{final  fL=new bE();final  kL=new cE();final  VL=new CB<l>();final  rL=new CB<l>();final  QL=new CB<l>();final  yL=new CB<l>();final  AM=new CB<l>();final  BM=new Map<Type,bC>();final  CM=new List<bC>();final  DM=new Map<Type,aC>();final  GM=new CB<aC>();var UC;eB(){FE(fL);FE(kL);} initialize(){GM.forEach((h)=>h.initialize());CM.forEach((g)=>g.initialize());} get MG=>fL; get EG=>kL; FE( g){DM[g.runtimeType]=g;GM.add(g);g.OL=this;} zB( g){return DM[g];} iC(){return fL.wL();} gB( g){return fL.LM(g);} SB( g,{ passive: false}){g.o=this;g.xL=passive;BM[g.runtimeType]=g;CM.add(g);return g;} NM( i, h(EntityObserver,Entity)){i.forEach((g){GM.forEach((j)=>h(j,g));CM.forEach((k)=>h(k,g));});i.clear();} process(){rG();CM.forEach((g){if(!g.bJ){g.process();}});} rG(){NM(VL,(h,g)=>h.GE(g));NM(rL,(h,g)=>h.pE(g));NM(AM,(h,g)=>h.disabled(g));NM(yL,(h,g)=>h.enabled(g));NM(QL,(h,g)=>h.BD(g));kL.AJ();} qI( g)=>VL.add(g); yI( g)=>rL.add(g); EJ( g){if(!QL.contains(g)){QL.add(g);}}}class fE extends aC{final  jL;final  lL;fE():jL=new Map<String,CB<l>>(),lL=new Map<l,CB<String>>(); initialize(){} add( i, j){var h=jL[j];if(h==null){h=new CB<l>();jL[j]=h;}h.add(i);var g=lL[i];if(g==null){g=new CB<String>();lL[i]=g;}g.add(j);} kJ( h){var g=lL[h];if(g!=null){g.forEach((j){var i=jL[j];if(i!=null){i.remove(h);}});g.clear();}} NJ( h){var g=jL[h];if(g==null){g=new CB<l>();jL[h]=g;}return g.readOnly;} BD( g)=>kJ(g);}class aF{static  NC( g)=>rH((g*cF).toInt()&gE);static  tC( g)=>sH((g*cF).toInt()&gE);static final  nH=12;static final  gE=~(-1<<nH);static final  CE=gE+1;static final  bF=jB.PI*2.0;static final  cF=CE/bF;static final  pH=dF(jB.sin);static final  qH=dF(jB.cos);static  rH(g)=>pH[g];static  sH(g)=>qH[g];static dF( i( x)){var h=new List<double>(CE);for(int g=0;g<CE;g++ ){h[g]=i((g+0.5)/CE*bF);}return h;}}abstract class bC implements VF{var nL=0;var o;var pL;var qL;var sL;var uL;var vL;var xL;bC( g):pL=new CB<l>(),qL=g.uF,sL=g.GJ,uL=g.aJ{vL=qL==0&&uL==0;nL=fH.hH(runtimeType);}get bJ=>xL; xF(){} process(){if(ZB()){xF();nD(pL.readOnly);end();}} end(){} nD( g); ZB(); initialize(){} SJ( g){} lJ( g){} NM( g){if(vL){return;}var i=OM(g);var h=(qL&g.oL)==qL;if(uL>0&&h){h=(uL&g.oL)>0;}if(sL>0&&h){h=(sL&g.oL)==0;}if(h&&!i){RM(g);}else if(!h&&i){SM(g);}} OM( g)=>(nL&g.AE)==nL; RM( g){pL.add(g);g.IM(nL);SJ(g);} SM( g){pL.remove(g);g.JM(nL);lJ(g);} GE( g)=>NM(g); pE( g)=>NM(g); enabled( g)=>NM(g); BD( g){if(OM(g)){SM(g);}} disabled( g){if(OM(g)){SM(g);}}}class UB extends qB with uC{ gL(){ZJ();} DG(){}}class VB{var qL=0;var sL=0;var uL=0; vF( g){qL=KM(qL,g);return this;}static  uB( h){var g=new VB();g.vF(h);return g;}static  uH()=>new VB(); get uF=>qL; get GJ=>sL; get aJ=>uL; KM( g, h){if(null!=h){h.forEach((i){g=g|VD.kH(i);});}return g;}}typedef  eF();abstract class uC{factory uC.yK( g, h){return ZF.lH(g,h);} DG(); ZJ(){DG();ZF.oH(this);}}class tH{var PM;var QM=0;tH():PM=new CB<int>(); zI(){if(PM.size>0){return PM.removeLast();}return QM++ ;}}abstract class vH<XD> extends DE<XD>{var VE;vH():super.zK(); open(){VE=VM();WM=true;return new bB.Future.value(true);} VM(); YM(){return new bB.Stream.fromIterable(VE.keys);} ZM( h, g){VE[g]=h;return new bB.Future.value(g);} bM(){return new bB.Stream.fromIterable(VE.values);}}class wH<XD> extends DE<XD>{static final  yH="1";static const  zH=5*1024*1024;var OD;var vB;var estimatedSize;var XM;wH(this.OD,this.vB,{this.estimatedSize: zH}):super.zK();static  get fF=>TH.SqlDatabase.supported; open(){if(!fF){return new bB.Future.error(new UnsupportedError('WebSQL is not supported on this platform'));}var g=new bB.Completer();XM=wB.window.openDatabase(OD,yH,OD,estimatedSize);aM(g);return g.future;} aM( h){var i='CREATE TABLE IF NOT EXISTS ${vB} (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT)';XM.transaction((g){g.executeSql(i,[] ,(g,k){WM=true;h.complete(true);});},(j)=>h.completeError(j));} YM(){var k='SELECT id FROM ${vB}';var g=new bB.StreamController();XM.transaction((j){j.executeSql(k,[] ,(j,i){for(var h=0;h<i.rows.length; ++h){var m=i.rows.item(h);g.add(m['id']);}});},(p)=>g.addError(p),()=>g.close());return g.stream;} ZM( j, h){var g=new bB.Completer();var k='INSERT OR REPLACE INTO ${vB} (id, value) VALUES (?, ?)';XM.transaction((i){i.executeSql(k,[h,j],(i,p){g.complete(h);});},(m)=>g.completeError(m));return g.future;} bM(){var k='SELECT id,value FROM ${vB}';var g=new bB.StreamController<XD>();XM.transaction((j){j.executeSql(k,[] ,(j,i){for(var h=0;h<i.rows.length; ++h){var m=i.rows.item(h);g.add(m['value']);}});},(p)=>g.addError(p),()=>g.close());return g.stream;}}class xH<XD> extends DE<XD>{var OD;var version;var XM;var vB;xH(this.OD,this.vB,{this.version: 1}):super.zK(){if(version==null){throw new ArgumentError("version must not be null");}}static  get fF=>SF.IdbFactory.supported; open(){if(!fF){return new bB.Future.error(new UnsupportedError('IndexedDB is not supported on this platform'));}return wB.window.indexedDB.open(OD,version:version,onUpgradeNeeded:(g){XM=g.target.result;if(!XM.objectStoreNames.contains(vB)){XM.createObjectStore(vB);}}).then((h){XM=h;WM=true;return true;});} ZM( g, i){return cM(( h){return h.put(g,i);});} cM( i( store),[ h='readwrite']){var m=new bB.Completer();var g=XM.transaction(vB,h);var j=g.objectStore(vB);var k=i(j);return g.completed.then((zK)=>k);} dM( h( cursor)){var g=new bB.StreamController<XD>();var j=XM.transaction(vB,'readonly');var i=j.objectStore(vB);i.openCursor(autoAdvance:true).listen((k)=>g.add(h(k)),onDone:()=>g.close(),onError:(m)=>g.addError(m));return g.stream;} bM(){return dM(( g)=>g.value);} YM(){return dM(( g)=>g.key);}}class OK<XD> extends vH<XD>{ VM(){return wB.window.localStorage;}}abstract class DE<XD>{var WM=false; get UJ=>WM;DE.zK();factory DE( i, h,[ g]){if(xH.fF){if(g!=null&&g['version']!=null){return new xH(i,h,version:g['version']);}else{return new xH(i,h);}}else if(wH.fF){if(g!=null&&g['estimatedSize']){return new wH(i,h,estimatedSize:g['estimatedSize']);}else{return new wH(i,h);}}else{return new OK();}}eM(){if(!UJ)throw new StateError('${runtimeType} is not open');} open(); keys(){eM();return YM();} YM(); save( h, g){eM();if(g==null){throw new ArgumentError("key must not be null");}return ZM(h,g);} ZM( g, h); uF(){eM();return bM();} bM();}const PK=const QK();class QK{const QK();}class AI{AI();}class gF{var RF=0;var bD=0.0;var GD=0.0;var zG=0.0;var dD=0.0;var LF=0.3;var SE=0.0;var UE=0.0;var NE=0.0;var EH=0.0;var QF=0.0;var MD=0.0;var KE=0.0;var yG=0.0;var KG=0.0;var TE=0.0;var kD=0.0;var lD=0.0;var QD=0.0;var fG=0.0;var wE=0.0;var PE=0.0;var VG=0.0;var hD=0.0;gF.BL( j){var g=j.split(",");this.RF=BI(g[0]);this.bD=TB(g[1]);this.GD=TB(g[2]);this.zG=TB(g[3]);this.dD=TB(g[4]);this.LF=TB(g[5]);this.SE=TB(g[6]);this.UE=TB(g[7]);this.NE=TB(g[8]);this.EH=TB(g[9]);this.QF=TB(g[10]);this.MD=TB(g[11]);this.KE=TB(g[12]);this.yG=TB(g[13]);this.KG=TB(g[14]);this.TE=TB(g[15]);this.kD=TB(g[16]);this.lD=TB(g[17]);this.QD=TB(g[18]);this.fG=TB(g[19]);this.wE=TB(g[20]);this.PE=TB(g[21]);this.VG=TB(g[22]);this.hD=TB(g[23]);if(this.GD<.01){this.GD=.01;}var i=this.bD+this.GD+this.dD;if(i<.18){var h=.18/i;this.bD*= h;this.GD*= h;this.dD*= h;}}static  BI( g){if(g==null||g.length==0){return 0;}return int.parse(g,radix:10);}static  TB( g){if(g==null||g.length==0){return 0.0;}return double.parse(g);}}class nB{static const hF="sfxr:";final  fM;var gM;var hM; get url=>hM;var iM;var kM=false;var mM='';var oM=false;var rM=false;nB.AL(this.fM,this.gM,this.hM); CN(){oM=false;iM=null;} OF(){return {"_url":hM,"_name":gM};} BJ(){kM=false;mM='OK';} TN( g){kM=true;mM=g;} UN( g, h){if(g==null){TN('Error decoding buffer.');h.complete(this);return;}BJ();iM=g;oM=true;h.complete(this);} VN( i, h){var j=i.response;fM.uM.decodeAudioData(j,(g)=>UN(g,h),(g)=>UN(g,h));} XN( h, g){TN('Error fetching data');g.complete(this);} load(){if(url==null){TN('No URL set.');return new bB.Future<nB>.value(this);}CN();if(url.startsWith(hF)){return new bB.Future<nB>.delayed(new Duration(milliseconds:1),(){iM=CI.DI(fM.uM,url.substring(hF.length));oM=true;return this;});}var g=new wB.HttpRequest();var h=new bB.Completer<nB>();if(rM){g.open('GET',url);}else{g.open('GET','${fM.baseURL}/${url}');}g.responseType='arraybuffer';g.onLoad.listen((i)=>VN(g,h));g.onError.listen((i)=>XN(g,h));g.onAbort.listen((i)=>XN(g,h));g.send();return h.future;} get length{if(iM==null){return 0;}return iM.duration;}}class OC{final  jM;final  lM;final  nM;var pM;var qM;var sM;var tM;var vM=1.0; get isScheduled=>pM==null?false:pM.playbackState==yD.AudioBufferSourceNode.SCHEDULED_STATE; get TJ=>pM==null?false:pM.playbackState==yD.AudioBufferSourceNode.FINISHED_STATE;OC.AL(this.jM,this.lM,this.nM){RN();} SN(){if(pM!=null){print('${pM.playbackState}');}} RN(){pM=jM.fM.uM.createBufferSource();if(lM!=null&&lM.iM!=null){pM.buffer=lM.iM;pM.loopStart=0.0;pM.loopEnd=lM.iM.duration;}pM.gain.value=vM;pM.loop=nM;pM.connect(jM.BN,0,0);} WN(){if(pM!=null){pM.stop(0.0);}pM=null;} get pause=>qM!=null; set pause( g){if(g){if(qM!=null){return;}YN();}else{if(qM==null){return;}ZN();}} aN(){assert(sM!=null);var g=jM.fM.uM.currentTime;var h=g-sM;if(g<tM){return g-tM;}if(nM){return h%pM.buffer.duration;}return h;} YN(){if(sM==null){return;}print('Sound.pause');SN();if(pM!=null){qM=aN();WN();print('paused at ${qM}');}} ZN(){if(qM==null){return;}print('Sound.resume');SN();RN();if(qM<0.0){qM=-qM;print('Scheduling to play sound in ${qM}.');tM=jM.fM.uM.currentTime+qM;pM.start(tM,0.0,pM.buffer.duration);sM=jM.fM.uM.currentTime;}else{print('Starting to play at offset ${qM}');tM=jM.fM.uM.currentTime;pM.start(tM,qM,pM.buffer.duration-qM);sM=jM.fM.uM.currentTime-qM;}qM=null;} play([ g=0.0]){WN();RN();tM=jM.fM.uM.currentTime+g;pM.start(tM);sM=jM.fM.uM.currentTime;} stop(){WN();sM=null;tM=null;qM=null;} get volume=>vM; set volume( g){if(pM!=null){pM.gain.value=g;}vM=g;}}class cC{cC();var uM;var wM;var xM;var yM;var AN;var DN;var baseURL;var IN=new Map<String,nB>();var MN=new Map<String,JD>();var QN; OF(){var g=new Map();g['masterVolume']=yM.gain.value;g['musicVolume']=AN.gain.value;g['sourceVolume']=DN.gain.value;g['clips']=IN;g['sources']=MN;g['music']=QN;return g;} get hD=>yM.gain.value; set hD( g){kG=false;yM.gain.value=g;}var HN; set kG( g){if(g){if(HN!=null){return;}HN=yM.gain.value;yM.gain.value=0;}else{if(HN==null){return;}yM.gain.value=HN;HN=null;}}var cN=false;var dN=false; gG( h, i){var g=IN[h];if(g!=null){return g;}g=new nB.AL(this,h,i);IN[h]=g;return g;} XJ( h){var g=MN[h];if(g!=null){return g;}g=new JD.AL(this,h,DN);MN[h]=g;return g;} nG( g, h,[ i=false]){return cJ(0.0,g,h,i);} cJ( j, i, k,[ m=false]){var g=MN[i];if(g==null){print('Could not find source ${i}');return null;}var h=IN[k];if(h==null){print('Could not find clip ${k}');return null;}if(m){return g.dJ(j,h);}else{return g.eJ(j,h);}}}class JD{var fM;var gM;var zM;var BN;var EN;var GN;var HN;var JN=false;var KN=0.0;var LN=0.0;var NN=0.0;var ON=true; PN(){EN.disconnect(0);BN.disconnect(0);if(ON){BN.connect(EN,0,0);EN.connect(zM,0,0);}else{BN.connect(zM,0,0);}}JD.AL(this.fM,this.gM,this.zM){BN=fM.uM.createGain();EN=fM.uM.createPanner();EN.coneOuterGain=1.0;PN();GN=new List<OC>();} set gJ( g){if(g!=ON){ON=g;PN();}} get volume=>BN.gain.value; set volume( g){BN.gain.value=g;} OF(){return {"_name":gM,"volume":BN.gain.value,"_mutedVolume":HN,"_isPaused":JN,"_x":KN,"_y":LN,"_z":NN};} set kG( g){if(g){if(HN!=null){return;}HN=volume;volume=0.0;}else{if(HN==null){return;}volume=HN;HN=null;}} eJ( i, h){var g=new OC.AL(this,h,false);GN.add(g);g.play(i);g.pause=pause;return g;} dJ( i, h){var g=new OC.AL(this,h,true);GN.add(g);g.play(i);g.pause=pause;return g;} bN(){for(int g=GN.length-1;g>=0;g-- ){var h=GN[g];if(h.TJ){var i=GN.length-1;GN[g]=GN[i];GN.removeLast();print('removing sound.');h.stop();}}} get pause=>JN; set pause( g){if(g){if(JN==true){return;}YN();JN=true;}else{if(JN==false){return;}ZN();JN=false;}} YN(){bN();GN.forEach((g){g.pause=true;});} ZN(){bN();GN.forEach((g){g.pause=false;});} stop(){GN.forEach((g){g.stop();});bN();} get x=>KN; get y=>LN;}class CI{final  eN;var fN,gN,hN,iN,jN,kN,lN,mN,nN,oN;var pN,qN;CI( this.eN); reset(){var g=this.eN;iN=100/(g.LF*g.LF+.001);jN=100/(g.SE*g.SE+.001);kN=1-g.UE*g.UE*g.UE*.01;lN=-g.NE*g.NE*g.NE*.000001;if(g.RF==0){nN=.5-g.yG/2;oN=-g.KG*.00005;}mN=g.MD>0?1-g.MD*g.MD*.9:1+g.MD*g.MD*10;pN=0;qN=(g.KE==1?0:(1-g.KE)*(1-g.KE)*20000+32).toInt();} tJ(){this.reset();var g=this.eN;fN=g.bD*g.bD*100000;gN=g.GD*g.GD*100000;hN=g.dD*g.dD*100000+10;return (fN+gN+hN).toInt();} pJ( m, p){var g=this.eN;var rN=g.QD!=1||g.PE!=0,sN=g.PE*g.PE*.1,tN=1+g.VG*.0003,uN=g.QD*g.QD*g.QD*.1,vN=1+g.fG*.0001,wN=g.QD!=1,xN=g.hD*g.hD,yN=g.SE,zN=g.kD!=0||g.lD!=0,AO=g.lD*g.lD*g.lD*.2,BO=g.kD*g.kD*(g.kD<0?-1020:1020),CO=(g.TE!=0)?(((1-g.TE)*(1-g.TE)*20000).toInt())+32:0,DO=g.zG,EO=g.EH/2,FO=g.QF*g.QF*.01,GO=g.RF;var HO=fN,IO=1/fN,JO=1/gN,KO=1/hN;var LO=5/(1+g.wE*g.wE*20)*(.01+uN);if(LO>.8){LO=.8;}LO=1-LO;var MO=false;var NO=0.0,OO=0.0,PO=0.0,QO=0.0,RO=0.0,SO=0.0,TO=0.0,UO=0.0,VO=0.0,WO=0.0,XO=0.0;var YO=0,ZO=0,aO=0,bO=0,cO=0,dO=0;var k=new jB.Random();var eO=new List<double>(1024),fO=new List<double>(32);for(var h=eO.length-1;h>-1;h-- ){eO[h]=0.0;}for(var h=fO.length-1;h>-1;h-- ){fO[h]=k.nextDouble()*2-1;}for(var h=0;h<p;h++ ){if(MO){return true;}if(CO!=0){if( ++dO>=CO){dO=0;this.reset();}}if(qN!=0){if( ++pN>=qN){qN=0;iN*= mN;}}kN+= lN;iN*= kN;if(iN>jN){iN=jN;if(yN>0){MO=true;}}WO=iN;if(EO>0){XO+= FO;WO*= 1+jB.sin(XO)*EO;}YO=WO.toInt();if(YO<8){YO=8;}if(GO==0){nN+= oN;if(nN<0){nN=0.0;}else if(nN>.5){nN=.5;}}if( ++NO>HO){NO=0.0;switch ( ++aO){case 1:HO=gN;break;case 2:HO=hN;break;}}switch (aO){case 0:OO=NO*IO;break;case 1:OO=1+(1-NO*JO)*2*DO;break;case 2:OO=1-NO*KO;break;case 3:OO=0.0;MO=true;break;}if(zN){BO+= AO;cO=BO.toInt();if(cO<0){cO=-cO;}else if(cO>1023){cO=1023;}}if(rN&&tN!=0.0){sN*= tN;if(sN<.00001){sN=.00001;}else if(sN>.1){sN=.1;}}VO=0.0;for(var j=0;j<8;j++ ){ZO++ ;if(ZO>=YO){ZO%= YO;if(GO==3){for(var i=fO.length-1;i>-1;i-- ){fO[i]=k.nextDouble()*2-1;}}}switch (GO){case 0:UO=((ZO/YO)<nN)?.5:-.5;break;case 1:UO=1-(ZO/YO)*2;break;case 2:TO=ZO/YO;TO=TO>.5?(TO-1)*6.28318531:TO*6.28318531;UO=TO<0?1.27323954*TO+.405284735*TO*TO:1.27323954*TO-.405284735*TO*TO;UO=UO<0?.225*(UO*-UO-UO)+UO:.225*(UO*UO-UO)+UO;break;case 3:UO=fO[(ZO*32/YO).abs().toInt()];break;}if(rN){RO=SO;uN*= vN;if(uN<0){uN=0;}else if(uN>.1){uN=.1;}if(wN){QO+= (UO-SO)*uN;QO*= LO;}else{SO=UO;QO=0.0;}SO+= QO;PO+= SO-RO;PO*= 1-sN;UO=PO;}if(zN){eO[bO%1024]=UO;UO+= eO[(bO-cO+1024)%1024];bO++ ;}VO+= UO;}VO*= .125*OO*xN;VO=VO>=1?1.0:VO<=-1?-1.0:VO;m[h]=VO;}return false;}static  DI( j, k){var i=new CI(new gF.BL(k));var h=i.tJ();var g=j.createBuffer(2,h,44100);assert(h<=g.length);i.pJ(g.getChannelData(0),h);return g;}}class iE{static const FI=EB-350;static const GI=50;static const II=300;static const KI=50;static const MI=70;static var iF=0;var label,content;var rect;var tE=false;iE(this.label,{this.content}){rect=new wB.Rect(FI,GI+iF*MI,II,KI);iF++ ;}}class RK extends ID{var gD;var SD;var NF;RK(this.gD); initialize(){var h=o.zB(DC);var g=h.gB(dC);SD=g.LJ(RB);} BC(){var g=new VK(gD.ME,gD.DD.toInt());NF=new DE<String>('space-off','highscore');NF.open().then((gO)=>NF.save(AK.stringify(g),g.dateTime.toString()));gD.UG=true;} ZB()=>SD.jC&&!gD.UG;}class SK extends sC{var cD;var wG;SK(this.cD):super(VB.uB([fC])); initialize(){wG=new u<fC>(fC,o);} nC( g){var h=wG.get(g);cD.nG(h.source,h.clip);g.GF(fC);g.LE();}}class YD{var QE;var qD;YD(this.QE,this.qD);}class TK extends EE{var context;var fB;var pD;var uD;var zC;TK(this.context,this.fB):super(VB.uB([cB,t])); initialize(){super.initialize();pD=new u<cB>(cB,o);uD=new u<rB>(rB,o);} xF(){var g=aB.gB(IC);zC=lB.get(g);} oD( g){var h=pD.get(g);drawImage(g,h);} drawImage( k, h){var g=GB.get(k);var j=uD.AC(k);context.save();try {context.lineWidth=0.5;context.fillStyle="white";context.strokeStyle="white";context.beginPath();if(zC.x>KB-EB&&g.x<EB){context.translate(KB,0);}if(zC.y>JB-PB&&g.y<PB){context.translate(0,JB);}context.translate(g.x,g.y);if(null!=j){context.globalAlpha=j.mG;}var m=h.scale;if(h.vE){var q=(g.angle.round()%h.VC.length).toInt();var i=fB.qD[h.VC[q]];JG(i,m);}else{context.rotate(g.angle);h.VC.forEach((p){var i=fB.qD[p];JG(i,m);});}context.closePath();context.fill();context.stroke();}finally {context.restore();}} JG( g, h){var i=new wB.Rect(g.GC.left*h,g.GC.top*h,g.GC.width*h,g.GC.height*h);context.drawImageToRect(fB.QE,i,sourceRect:g.src);}}class EI extends ZD{static const  HI=wB.KeyCode.W;static const  JI=wB.KeyCode.A;static const  LI=wB.KeyCode.D;static const  NI=wB.KeyCode.J;static const  OI=wB.KeyCode.H;static const  QI=wB.KeyCode.E;static const  RI=wB.KeyCode.UP;static const  SI=wB.KeyCode.LEFT;static const  TI=wB.KeyCode.RIGHT;static const  UI=wB.KeyCode.CTRL;static const  VI=wB.KeyCode.SHIFT;static const  XI=wB.KeyCode.SPACE;var mB=new Map<int,bool>();var FD;var wD;var yB;var HB;var iB;var PF;var canvas;var state;var YG;var ZG;EI(this.canvas); initialize(){super.initialize();var g=new u<BB>(BB,o);var j=new u<oB>(oB,o);var h=new u<cB>(cB,o);var i=new u<sB>(sB,o);var k=new u<QB>(QB,o);var m=new u<KC>(KC,o);FD=h.get(hB);wD=g.get(hB);yB=j.get(hB);HB=i.get(hB);iB=k.get(hB);PF=m.get(hB);YG=canvas.onKeyDown.listen(PJ);ZG=canvas.onKeyUp.listen(QJ);} BC(){if(mI){HB.OB=true;FD.VC=['spaceship.png'];yB.ED=false;iB.OB=false;iB.YC=QB.KD;YG.cancel();ZG.cancel();}else{if(lI){if(!iB.OB){iB.OB=true;FD.VC=['spaceship.png','spaceship_thrusters.png'];}}else{if(iB.OB){iB.OB=false;FD.VC=['spaceship.png'];}}if(nI){PF.OB=true;}if(uJ){iB.YC=QB.jI;}else if(vJ){iB.YC=QB.kI;}else{iB.YC=QB.KD;}yB.ED=ED;}} jJ()=>mB.keys.forEach((g)=>mB[g]=false); get lI=>mB[HI]==true||mB[RI]==true; get uJ=>mB[JI]==true||mB[SI]==true; get vJ=>mB[LI]==true||mB[TI]==true; get mI=>(mB[OI]==true||mB[VI]==true)&&HB.enabled; get ED=>mB[NI]==true||mB[UI]==true; get nI=>(mB[QI]==true||mB[XI]==true)&&PF.wI; PJ( g){g.preventDefault();mB[g.keyCode]=true;} QJ( g){g.preventDefault();mB[g.keyCode]=false;} ZB()=>DB.WC&&status.HC>0&&!HB.OB;}class vC{var src;var GC;var x,y,oC,kC,cx,cy;vC( k){var g=new YI(k);var h=g.OE;var i,j;if(g.BH){i=-(g.JF.oC~/2-g.KF.x);j=-(g.JF.kC~/2-g.KF.y);}else{i=-g.OE.oC~/2;j=-g.OE.kC~/2;}src=new wB.Rect(h.x,h.y,h.oC,h.kC);GC=new wB.Rect(i,j,h.oC,h.kC);}}class UK extends ID with cI{var canvas;var context;var jD;var yE=[new iE('START GAME'),new iE('INSTRUCTIONS'),new iE('CREDITS'),new iE('HIGHSCORE')];UK(this.canvas){context=canvas.context2D;}initialize(){jD=UF(EB,PB)..textBaseline='top'..font='20px D3Radicalism'..globalAlpha=0.5;canvas.onMouseMove.listen((i){var h=UD.ZE(i);yE.forEach(( g){if(g.rect.containsPoint(h)){g.tE=true;}else{g.tE=false;}});});canvas.onMouseDown.listen((i){var h=UD.ZE(i);if(yE[0].rect.containsPoint(h)){if(!DB.MF)DB.MF=true;if(!DB.paused)DB.paused=false;}});} BC(){context.save();try {jD..clear()..fillStyle='gray'..fillRect(0,0,EB,PB)..uG(10,10,EB-20,PB-20,50,strokeStyle:'blue',fillStyle:'red');yE.forEach(( g){var i=g.tE?'gold':'white';var h=jD.qJ(g.label);jD..uG(g.rect.left,g.rect.top,g.rect.width,g.rect.height,20,strokeStyle:'green',fillStyle:i)..OJ(g.label,g.rect.left+(g.rect.width-h.width)~/2,g.rect.top+(g.rect.height-h.height)~/2,[0,'black',1,'blue']);});context.translate(RG(o).x,RG(o).y);context.drawImage(jD.canvas,0,0);}finally {context.restore();}} ZB()=>!DB.WC;} WI( i){var h;var g='resources/sfx/';var j=i.lastIndexOf('/');if(j<0){g='/${g}';}else{g='${i.substring(0,j)}/${g}';}try {h=new WK(g);var k=h.XJ('non-positional');k.gJ=false;}catch (m){h=new WK(g);}h.gG('shoot','shoot.ogg').load();return h;}class YI{var OE;var BH;var KF;var JF;YI( g):OE=new jF(g["frame"]),BH=g["trimmed"],KF=new jF(g["spriteSourceSize"]),JF=new ZI(g["sourceSize"]);}class VK{final  dateTime;final  DD,cG;VK(this.cG,this.DD):dateTime=new DateTime.now(); OF()=>{'score':DD,'level':cG,'ms':dateTime.millisecondsSinceEpoch,'utc':dateTime.isUtc};}class jF{var x,y,oC,kC;jF( g):x=g["x"].toInt(),y=g["y"].toInt(),oC=g["w"].toInt(),kC=g["h"].toInt();}class WK implements cC{var baseURL;WK([this.baseURL='/']);var hO=new Map<String,aI>(); gG( h, i){var g=hO[h];if(g!=null){return g;}g=new aI.CL(this,h,"${baseURL}${i}");hO[h]=g;return g;} nG( h, g,[ i=false]){hO[g].play();return null;} noSuchMethod( g){}}class ZI{var oC,kC;ZI( g):oC=g["w"].toInt(),kC=g["h"].toInt();}class aI implements nB{final  iO;var jO;var kO;var HE=new List();aI.CL(this.iO,this.jO,this.kO); load(){var g=new wB.AudioElement();var h=new bB.Completer<nB>();g.onLoad.listen((i)=>h.complete(this));g.src=kO;HE.add(g);return h.future;} play(){var h=HE.where((i)=>i.ended).iterator;var g;if(h.moveNext()){g=h.current;}else{g=HE[0].clone(false);HE.add(g);}g.play();} noSuchMethod( g){}}class bI extends ZD{var context;var lB;var HB;bI(this.context); initialize(){super.initialize();lB=new u<FB>(FB,o);var g=new u<sB>(sB,o);HB=g.get(hB);} BC(){var h=aB.gB(IC);var g=lB.get(h);mJ(g);} mJ( g){context.setTransform(1,0,0,1,0,0);context.translate(-g.x,-g.y);context..fillStyle="black"..beginPath()..rect(g.x,g.y,EB,PB)..fill()..stroke()..closePath();} ZB()=>!HB.OB||status.jC;}class XK extends bI{var HB;XK(g):super(g); initialize(){super.initialize();var g=new u<sB>(sB,o);HB=g.get(hB);} BC(){var i=aB.gB(IC);var h=lB.get(i);var g=HB.lC;context.setTransform(1/(1+g/50),0,0,1+g,EB/2-(EB/(2*(1+g/50))),0);context.translate(-h.x,-h.y-(20*g));context.globalAlpha=jB.max(0.05,1-(g));context..fillStyle="black"..beginPath()..rect(h.x,h.y,EB,PB)..fill()..stroke()..closePath();context.globalAlpha=1;} ZB()=>HB.OB&&!status.jC;}class YK extends ID{static const  PC=64;static const  QC=64;var FC;var fB;var context;var lB;var aB;YK(this.context,this.fB); initialize(){lB=new u<FB>(FB,o);aB=o.zB(new DC().runtimeType);RJ();} RJ(){var w=o.zB(new fE().runtimeType);var q=new u<t>(t,o);FC=new wB.CanvasElement(width:KB+PC*2,height:JB+QC*2);var h=FC.context2D;h.setTransform(1,0,0,1,0,0);h.translate(PC,QC);var j=fB.qD['star_00.png'];var g=UF(128,128)..translate(64,64)..drawImageToRect(fB.QE,j.GC,sourceRect:j.src);var k=new List<wB.CanvasElement>(32);for(int i=0;i<32;i++ ){g.nJ(hue:YB.nextDouble(),saturation:0.5+YB.nextDouble()/2,lightness:0.5+YB.nextDouble()/2);k[i]=g.copy();}w.NJ(qF).forEach((p){var m=q.get(p);h.drawImage(k[YB.nextInt(20)],m.x-g.canvas.width~/2,m.y-g.canvas.height~/2);p.eD();});} BC(){var AB=aB.gB(IC);var g=lB.get(AB);context.save();try {context.beginPath();var m=g.x+PC;var p=g.y+QC;if(g.x<KB-EB&&g.y<JB-PB){context.drawImageScaledFromSource(FC,m,p,EB,PB,g.x,g.y,EB,PB);}else if(g.x>KB-EB&&g.y<JB-PB){var j=KB-g.x+PC;var k=EB-(KB-g.x)+PC;var q=KB-PC;context.drawImageScaledFromSource(FC,m,p,j,PB,g.x,g.y,j,PB);context.drawImageScaledFromSource(FC,0,p,k,PB,q,g.y,k,PB);}else if(g.x<KB-EB&&g.y>JB-PB){var h=JB-g.y+QC;var i=PB-(JB-g.y)+QC;var w=JB-QC;context.drawImageScaledFromSource(FC,m,p,EB,h,g.x,g.y,EB,h);context.drawImageScaledFromSource(FC,m,0,EB,i,g.x,w,EB,i);}else{var j=KB-g.x+PC;var k=EB-(KB-g.x)+PC;var h=JB-g.y+QC;var i=PB-(JB-g.y)+QC;var q=KB-PC;var w=JB-QC;context.drawImageScaledFromSource(FC,m,p,j,h,g.x,g.y,j,h);context.drawImageScaledFromSource(FC,0,p,k,h,q,g.y,k,h);context.drawImageScaledFromSource(FC,m,0,j,i,g.x,w,j,i);context.drawImageScaledFromSource(FC,0,0,k,i,q,w,k,i);}context.closePath();}finally {context.restore();}}}class ZK extends sC{var context;var GB;var lG;var zC;ZK(this.context):super(VB.uB([yC,t])); initialize(){GB=new u<t>(t,o);lG=new u<yC>(yC,o);var g=new u<FB>(FB,o);var h=o.zB(new DC().runtimeType);var i=h.gB(IC);zC=g.get(i);} nC( h){var g=GB.get(h);var i=lG.get(h);context.save();try {if(zC.x>KB-EB&&g.x<EB){context.translate(KB,0);}if(zC.y>JB-PB&&g.y<PB){context.translate(0,JB);}context.translate(g.x,g.y);context.fillStyle=i.color;context.fillRect(0,0,1,1);}finally {context.restore();}}}class aK extends ZD{static const kF="Score:";static const lF="Level:";var context;var vG,eG;var fB;aK(this.context,this.fB); initialize(){super.initialize();var g=context.measureText(kF);vG=550-g.width;g=context.measureText(lF);eG=550-g.width;} BC(){context.save();context.transform(1,0,0,1,90,12);try {context.beginPath();context.fillStyle="black";context.fillRect(0,0,200,15);context.fillStyle="green";context.fillRect(0,0,200*status.HC/status.iD,15);context.closePath();}finally {context.restore();}var g=fB.qD['hud_dummy.png'];context.translate(-g.GC.left,-g.GC.top);context.drawImageToRect(fB.QE,g.GC,sourceRect:g.src);context.translate(g.GC.left,g.GC.top);var j="${DB.DD.toStringAsFixed(0)}";var i="${(DB.ME+1).toString()}";context.fillText(lF,eG,11);context.fillText(kF,vG,31);var h=context.measureText(i);context.fillText(i,680-h.width,11);h=context.measureText(j);context.fillText(j,680-h.width,31);}}class bK extends bC{var context;var GB;var sG;var kB;bK(this.context):super(VB.uB([wC,t,NB])); initialize(){GB=new u<t>(t,o);sG=new u<wC>(wC,o);kB=new u<NB>(NB,o);} nD( k){context.save();context.transform(80/KB,0,0,80/JB,EB-90,10);try {context.fillStyle="black";context.beginPath();context.fillRect(0,0,KB,JB);context.closePath();k.forEach((h){var j=GB.get(h);var i=sG.get(h);var g=kB.get(h);context.fillStyle=i.color;context.strokeStyle=i.color;context.beginPath();context.fillRect(j.x-g.dB,j.y-g.dB,g.dB*2,g.dB*2);context.closePath();});}finally {context.restore();}} ZB()=>true;}abstract class cI{var lO; RG( g){if(null==lO){var h=new u<FB>(FB,g);var i=g.zB(new DC().runtimeType);var j=i.gB(IC);lO=h.get(j);}return lO;}}class dI{static final  mF=new Map<String,wB.ImageElement>();static  eI( h, i( image)){var g=mF[h];if(null==g){g=new wB.ImageElement();g.onLoad.listen((j){mF[h]=g;i(g);});g.src="resources/img/${h}";}else{i(g);}}}abstract class ZD extends ID{var aB;var hB;var status; initialize(){var g=new u<RB>(RB,o);aB=o.zB(new DC().runtimeType);hB=aB.gB(dC);status=g.get(hB);}}class t extends UB{var mO,nO,angle,rotationRate;t.DL();static  fI()=>new t.DL();factory t( i, h,{ angle: 0, rotationRate: 0}){var g=new uC.yK(t,fI);g.x=i;g.y=h;g.angle=angle;g.rotationRate=rotationRate;return g;} get x=>mO; get y=>nO;set x( g)=>mO=g%KB;set y( g)=>nO=g%JB;}abstract class nF extends bC{static final  oF=EB+50;static final  pF=PB+50;static final  gI=KB-oF;static final  hI=JB-pF;var GB;var lB;var aB;nF( g):super(g.vF([t])); initialize(){GB=new u<t>(t,o);lB=new u<FB>(FB,o);aB=o.zB(new DC().runtimeType);} nD( m){var k=aB.gB(IC);var h=lB.get(k);var g=new CB<l>();m.forEach((i){var j=GB.get(i);if(VJ(j,h)&&WJ(j,h)){g.add(i);}});FF(g.readOnly);} VJ( i, h){var g=(h.x-i.x).abs();return (g<oF||g>gI);} WJ( i, h){var g=(h.y-i.y).abs();return (g<pF||g>hI);} FF( g); ZB()=>true;}const  EB=800;const  PB=400;const  iI=100;const  JB=PB*4;const  KB=EB*2;class cK extends ZD{var yB;var transform;var FD;var iB; initialize(){super.initialize();var i=new u<oB>(oB,o);var g=new u<t>(t,o);var h=new u<cB>(cB,o);var j=new u<QB>(QB,o);yB=i.get(hB);transform=g.get(hB);FD=h.get(hB);iB=j.get(hB);} BC(){if(!status.jC&&status.HC<0){yB.ED=false;iB.OB=false;iB.YC=QB.KD;status.jC=true;FD.VC=['spaceship.png'];transform.rotationRate=0.1;hB.GF(RC);hB.LE();}} ZB()=>!status.jC;}const  jE=11;const  IC="CAMERA";const  dC="PLAYER";const  qF="GROUP_BACKGROUND";class FB extends UB{var mO,nO;FB.DL();static  fI()=>new FB.DL();factory FB({ x: 0, y: 0}){var g=new uC.yK(FB,fI);g.x=x;g.y=y;return g;} get x=>mO; get y=>nO;set x( g)=>mO=g%KB;set y( g)=>nO=g%JB;}final  YB=new jB.Random();final  DB=new kE();class kE{var ME=0;var dG=1.0;var zE=false;var paused=false;var MF=false;var UG=false;var DD=0.0; get WC=>MF&&!paused;} rF( k, j){var g=JC(k,j);var h=JC(0,MB.MC);var m=g*MB.NC(h);var i=g*MB.tC(h);return new BB(m,i);}class BB extends UB{var x,y;BB.DL();static  fI()=>new BB.DL();factory BB( i, h){var g=new uC.yK(BB,fI);g.x=i;g.y=h;return g;} get absolute=>jB.sqrt(x*x+y*y); get angle=>jB.atan2(y,x);} JC( g, i){var h=g+(i-g)*YB.nextDouble();return h;} sF( IB, q, w, pC, m){for(int p=0;p<pC;p++ ){var g=IB.iC();var LC=YB.nextDouble()*w*MB.NC(MB.MC*YB.nextDouble());var WB=YB.nextDouble()*w*MB.NC(MB.MC*YB.nextDouble());g.v(new t(q.x+LC,q.y+WB));var tB=m.absolute;var i=m.angle;var h=JC(0.8,2);var AB=tB*h;var j;if(h<1){j=(h-0.8)*5;}else{j=2-h;}var k=0.05*JC(-j,j);var qC=jB.cos(i)*AB+jB.cos(i+jB.PI/2)*k;var rC=jB.sin(i)*AB+jB.sin(i+jB.PI/2)*k;g.v(new BB(qC,rC));g.v(new yC("grey"));g.v(new rB(250+YB.nextInt(500)));g.hC();}}class QB extends UB{static const KD=0;static const jI=-1;static const kI=1;var OB;var rD;var YC;QB.DL();static  fI()=>new QB.DL();factory QB({ thrust: 0.0002}){var g=new uC.yK(QB,fI);g.rD=thrust;g.OB=false;g.YC=KD;return g;}}class dK extends sC{var wF;var GB;var XB;dK():super(VB.uB([RC,t,BB])); initialize(){wF=new u<RC>(RC,o);GB=new u<t>(t,o);XB=new u<BB>(BB,o);} nC( i){var g=wF.get(i);var j=GB.get(i);var h=(g.angle-j.angle)%MB.MC;if(h>jB.PI){h-= MB.MC;}if(h.abs()>0.001){j.angle+= h*0.08;}else{var k=XB.get(i);k.x=g.wD*jB.cos(g.angle);k.y=g.wD*jB.sin(g.angle);}} ZB()=>DB.WC;}abstract class EE extends nF{EE( g):super(g); initialize(){super.initialize();} FF( h){h.forEach((g)=>oD(g));} oD( g);}class KC extends UB with tF{var enabled,OB;var tD,xE;var AF,mC,BF,vD;KC.DL();static  fI()=>new KC.DL();factory KC({ cooldownTime: 5000.0, maxTimeActive: 400.0}){var g=new uC.yK(KC,fI);g.enabled=true;g.OB=false;g.tD=0.0;g.xE=maxTimeActive;g.rE=cooldownTime;g.AD=0.0;g.mC=null;g.AF=null;g.BF=null;g.vD=null;return g;} get wI{if(enabled&&FG)return true;return false;}}class eK extends sC{var XB;var pB;var sD;var CH;var GB;eK():super(VB.uB([QB,BB,LB,t,KC])); initialize(){XB=new u<BB>(BB,o);pB=new u<LB>(LB,o);sD=new u<QB>(QB,o);CH=new u<KC>(KC,o);GB=new u<t>(t,o);} nC( k){var j=sD.get(k);var g=CH.get(k);if(j.OB||j.YC!=QB.KD||g.OB){var i=GB.get(k);var h=XB.get(k);var IB=pB.get(k);var p=jB.sqrt(2*j.rD/IB.value);if(j.YC!=QB.KD){i.angle=(i.angle+p*j.YC*15)%MB.MC;}if(g.OB){g.tG();if(g.mC==null){g.mC=jB.sqrt(h.x*h.x+h.y*h.y);g.AF=h.x;g.BF=h.y;g.vD=500*p;}var m=g.tD/g.xE;var q=jB.pow(1-(2*(-0.5+m).abs()),1.5);var w=g.AF*(1-m)+g.mC*MB.tC(i.angle)*m;var AB=g.BF*(1-m)+g.mC*MB.NC(i.angle)*m;h.x=w+q*g.vD*MB.tC(i.angle);h.y=AB+q*g.vD*MB.NC(i.angle);g.tD+= o.UC;if(g.tD>g.xE){g.OB=false;g.tD=0.0;h.x=g.mC*MB.tC(i.angle);h.y=g.mC*MB.NC(i.angle);g.mC=null;g.vD=null;}}else{g.AD-= o.UC;if(j.OB){h.x+= p*MB.tC(i.angle);h.y+= p*MB.NC(i.angle);}}}} ZB()=>DB.WC;}class fK extends ZD{var HB;var RE=false;fK():super(); initialize(){super.initialize();var g=new u<sB>(sB,o);HB=g.get(hB);} BC(){var g;if(!HB.TD){HB.lC+= 0.01+HB.lC*0.005;}else{HB.lC-= 0.01+HB.lC*0.005;if(HB.lC<0.001){HB.OB=false;HB.TD=false;}}if(HB.lC>0.5){if(!RE&&!HB.TD){RE=true;}}else{if(RE){RE=false;}}} ZB()=>HB.OB&&!status.jC&&DB.WC;}class cB extends UB{var VC;var scale;var vE;cB.DL();static  fI()=>new cB.DL();factory cB( g,{ scale: 1}){return lE([g],scale,false);}factory cB.EL( g,{ scale: 1}){return lE(g,scale,true);}factory cB.FL( g, h){return lE(g.VC,h,g.vE);}static  lE( h, j, i){var g=new uC.yK(cB,fI);g.VC=h;g.scale=j;g.vE=i;return g;}}class RB extends UB{var HC,iD,YJ;var jC=false;RB.DL();static  fI()=>new RB.DL();factory RB({ maxHealth: 100, maxVelocity: 20}){var g=new uC.yK(RB,fI);g.iD=maxHealth;g.YJ=maxVelocity;g.HC=maxHealth;return g;}}class NB extends UB{var dB;NB.DL();static  fI()=>new NB.DL();factory NB( h){var g=new uC.yK(NB,fI);g.dB=h;return g;}}class LB extends UB{var value;LB.DL();static  fI()=>new LB.DL();factory LB( h){var g=new uC.yK(LB,fI);g.value=h;return g;}}class oB extends UB with tF{var ED;var JE,oE,nE;var SC;oB.DL();static  fI()=>new oB.DL();factory oB({ cooldownTime: 200.0, bulletSpeed: 0.5, bulletMass: 0.1, bulletDamage: 5.0, amount: 1}){var g=new uC.yK(oB,fI);g.JE=bulletSpeed;g.oE=bulletMass;g.nE=bulletDamage;g.SC=amount;g.ED=false;g.rE=cooldownTime;g.AD=0.0;return g;} get vI{if(ED&&FG)return true;return false;}}class gK extends sC{var GB;var XB;gK():super(VB.uB([t,BB])); initialize(){GB=new u<t>(t,o);XB=new u<BB>(BB,o);} nC( h){var g=GB.get(h);var i=XB.get(h);g.x+= i.x*o.UC;g.y+= i.y*o.UC;g.angle+= g.rotationRate;} ZB()=>DB.WC;}class rB extends UB{var jG,HD;rB.DL();static  fI()=>new rB.DL();factory rB( h){var g=new uC.yK(rB,fI);g.jG=h;g.HD=h;return g;} HJ( g){HD-= g;if(NG){HD=0;}} get NG=>HD<=0; get mG=>HD/jG;}class hK extends ID{var mD;var lB;var aB;hK(); initialize(){mD=new u<t>(t,o);lB=new u<FB>(FB,o);aB=o.zB(new DC().runtimeType);} BC(){var i=aB.gB(dC);var j=aB.gB(IC);var h=mD.get(i);var g=lB.get(j);g.x=h.x-EB~/2;g.y=h.y-PB~/2;}}class wC extends UB{var color;wC.DL();static  fI()=>new wC.DL();factory wC( h){var g=new uC.yK(wC,fI);g.color=h;return g;}}class eC extends UB{var name;var OG;var LG;var TG,iG;var zF;var yF,AH;eC.DL();static  fI()=>new eC.DL();factory eC( h,{ healthGain: 0, massGain: 0, fillHealth: false, bullets: 0, bulletDamageGain: 0.0, thrustGain: 0.0, enableHyperDrive: false}){var g=new uC.yK(eC,fI);g.name=h;g.TG=healthGain;g.OG=fillHealth;g.zF=bullets;g.LG=enableHyperDrive;g.yF=bulletDamageGain;g.iG=massGain;g.AH=thrustGain;return g;}}class iK extends EE{var kB;var DH;var status;var transform;var body;var yB;var HB;var hG;var iB;iK():super(VB.uB([eC,t,NB])); initialize(){super.initialize();var h=o.zB(new DC().runtimeType);var g=h.gB(dC);kB=new u<NB>(NB,o);DH=new u<eC>(eC,o);var i=new u<oB>(oB,o);var p=new u<sB>(sB,o);var m=new u<RB>(RB,o);var j=new u<LB>(LB,o);var k=new u<QB>(QB,o);status=m.get(g);transform=GB.get(g);body=kB.get(g);yB=i.get(g);HB=p.get(g);iB=k.get(g);hG=j.get(g);} oD( h){var i=GB.get(h);var j=kB.get(h);if(aE.hE(transform.x,transform.y,body.dB,i.x,i.y,j.dB)){var g=DH.get(h);status.iD+= g.TG;if(g.OG){status.HC=status.iD;}yB.SC=yB.SC==jE?jE:yB.SC+g.zF;yB.nE+= g.yF;if(g.LG){HB.enabled=true;}hG.value+= g.iG;iB.rD+= g.AH;h.eD();}} end(){o.rG();} ZB()=>!DB.paused&&status.HC>0;}class EC extends UB{var value,maxValue;EC.DL();static  fI()=>new EC.DL();factory EC( h){var g=new uC.yK(EC,fI);g.maxValue=h;g.value=h;return g;}}class xC extends UB{var CD;xC.DL();static  fI()=>new xC.DL();factory xC( h){var g=new uC.yK(xC,fI);g.CD=h;return g;}}class mE extends UB{mE.DL();static  fI()=>new mE.DL();factory mE()=>new uC.yK(mE,fI);}class fC extends UB{var source,clip;fC.DL();static  fI()=>new fC.DL();factory fC( h, i){var g=new uC.yK(fC,fI);g.source=h;g.clip=i;return g;}}class yC extends UB{var color;yC.DL();static  fI()=>new yC.DL();factory yC( h){var g=new uC.yK(yC,fI);g.color=h;return g;}}class RC extends UB{var angle,wD;RC.DL();static  fI()=>new RC.DL();factory RC({ angle, velocity}){var g=new uC.yK(RC,fI);g.angle=angle;g.wD=velocity;return g;}}class jK extends nF{var GB;var kB;var XB;var pB;var XC;var ND;var sE;var HF;var IF;jK():super(VB.uB([NB,t,BB,LB])); initialize(){super.initialize();GB=new u<t>(t,o);kB=new u<NB>(NB,o);XB=new u<BB>(BB,o);pB=new u<LB>(LB,o);XC=new u<RB>(RB,o);ND=new u<EC>(EC,o);sE=new u<rB>(rB,o);HF=new u<LD>(LD,o);IF=new u<gC>(gC,o);} FF( q){if(q.size>1){for(int WB=0;WB<q.size-1;WB++ ){var m=q[WB];var k=GB.get(m);var FH=kB.get(m);for(int qC=WB+1;qC<q.size;qC++ ){var p=q[qC];var j=GB.get(p);var GH=kB.get(p);if(aE.hE(k.x,k.y,FH.dB,j.x,j.y,GH.dB)){var g=XB.get(m);var i=XB.get(p);var pC=pB.get(m);var rC=pB.get(p);var w=j.x-k.x;var IB=j.y-k.y;var xD=jB.sqrt(w*w+IB*IB);var HH=FH.dB+GH.dB;var xJ=HH-xD;if(xJ>0){var IH=i.x-g.x;var JH=i.y-g.y;var AB=(xD-HH)/jB.sqrt(IH*IH+JH*JH);k.x+= AB*g.x;k.y+= AB*g.y;j.x+= AB*i.x;j.y+= AB*i.y;w=j.x-k.x;IB=j.y-k.y;}var h=jB.atan2(IB,w);var KH=jB.sqrt(g.x*g.x+g.y*g.y);var WE=jB.sqrt(i.x*i.x+i.y*i.y);var LH=jB.atan2(g.y,g.x);var MH=jB.atan2(i.y,i.x);var XE=KH*jB.cos(LH-h);var yJ=KH*jB.sin(LH-h);var NH=WE*jB.cos(MH-h);var zJ=WE*jB.sin(MH-h);var LC=XE*pC.value;var tB=NH*rC.value;var OH=pC.value+rC.value;var PH=(LC+2*tB-rC.value*XE)/OH;var QH=(tB+2*LC-pC.value*NH)/OH;var RH=yJ;var SH=zJ;g.x=jB.cos(h)*PH+jB.cos(h+jB.PI/2)*RH;g.y=jB.sin(h)*PH+jB.sin(h+jB.PI/2)*RH;i.x=jB.cos(h)*QH+jB.cos(h+jB.PI/2)*SH;i.y=jB.sin(h)*QH+jB.sin(h+jB.PI/2)*SH;iJ(m,p,LC,tB);wJ(m,p);}}}}} iJ( g, h, j, m){var i=XC.AC(g);var k=XC.AC(h);var p=ND.AC(g);var q=ND.AC(h);var AB=HF.AC(g);var w=HF.AC(h);var IB=IF.AC(g);var WB=IF.AC(h);BG(i,q,j,m);BG(k,p,j,m);AG(AB,WB,k);AG(w,IB,i);} BG( g, h, j, i){if(null!=g){g.HC-= (i.abs()+j.abs())/5;if(null!=h)g.HC-= h.value;}} AG( i, g, h){if(null!=i&&null!=g){if(null!=h&&h.HC<0){DB.DD+= g.aG;}else{DB.DD+= g.IG;}}} wJ( i, j){var g=sE.AC(i);var h=sE.AC(j);if(null!=g){g.HD*= 0.8;}if(null!=h){h.HD*= 0.8;}} ZB()=>DB.WC;}class sB extends UB{var enabled,OB,TD;var lC;sB.DL();static  fI()=>new sB.DL();factory sB(){var g=new uC.yK(sB,fI);g.enabled=false;g.OB=false;g.TD=false;g.lC=0.0;return g;}}class gC extends UB{var IG,aG;gC.DL();static  fI()=>new gC.DL();factory gC( h, i){var g=new uC.yK(gC,fI);g.IG=h;g.aG=i;return g;}}class LD extends UB{LD.DL();factory LD()=>new uC.yK(LD,()=>new LD.DL());}abstract class tF{var AD,rE; get FG=>AD<=0; tG(){AD=rE;}}class kK extends sC{var GB;var CG;var XB;var pB;kK():super(VB.uB([oB,t,BB,LB])); initialize(){GB=new u<t>(t,o);XB=new u<BB>(BB,o);pB=new u<LB>(LB,o);CG=new u<oB>(oB,o);} nC( h){var g=CG.get(h);if(g.vI){IJ(h,g);}else if(g.AD>0){g.AD-= o.UC;}} IJ( p, g){var j=GB.get(p);var i=XB.get(p);var w=pB.get(p);g.tG();var WB=MB.tC(j.angle);var AB=MB.NC(j.angle);for(int m=0;m<g.SC;m++ ){var k;if(g.SC==1){k=j.angle;}else{k=j.angle+jB.PI/4-((jB.PI/(2*(g.SC-1)))*m);}var h=o.iC();h.v(new t(j.x+jB.cos(k)*26,j.y+jB.sin(k)*26));h.v(new BB(i.x+g.JE*WB,i.y+g.JE*AB));h.v(new NB(2));h.v(new LB(g.oE));h.v(new cB('bullet_dummy.png'));h.v(new rB(2500));h.v(new EC(g.nE));h.v(new fC('non-positional','shoot'));h.v(new LD());h.hC();} IB( i, LC){var q=i*w.value;var tB=g.JE*LC*g.oE*g.SC;q=q-tB;return q/w.value;}i.x=IB(i.x,WB);i.y=IB(i.y,AB);} ZB()=>DB.WC;}class lK extends sC{var uD;var ND;lK():super(VB.uB([rB])); initialize(){uD=new u<rB>(rB,o);ND=new u<EC>(EC,o);} nC( g){var i=uD.get(g);if(i.NG){g.eD();}else{i.HJ(o.UC);var h=ND.AC(g);if(null!=h){h.value=h.maxValue*i.mG;}}} ZB()=>DB.WC;}class mK extends EE{var XC;var xG;var kB;var XB;var pB;var pD;mK():super(VB.uB([xC,NB,RB,BB,LB,cB])); initialize(){super.initialize();XC=new u<RB>(RB,o);xG=new u<xC>(xC,o);kB=new u<NB>(NB,o);XB=new u<BB>(BB,o);pB=new u<LB>(LB,o);pD=new u<cB>(cB,o);} oD( h){var WB=XC.get(h);if(WB.HC<=0){var IB=GB.get(h);var i=xG.get(h);var XE=pB.get(h);var w=XB.get(h);var m=kB.get(h);var LC=pD.get(h);var WE=jB.PI*m.dB*m.dB;var q=2*jB.PI/i.CD;var AB=jB.sqrt(i.CD);var p=m.dB/AB;var pC=(1*jB.PI/6)/((i.CD-1));var xD=w.angle-jB.PI/12;var tB=w.absolute;var k;if(i.CD==2){k=p;}else{k=jB.sin((180-q)/2)*p/jB.sin(q);}k+= 10;for(int j=0;j<i.CD;j++ ){var qC=j*q;var g=o.iC();g.v(new t(IB.x+k*jB.cos(qC),IB.y+k*jB.sin(qC),angle:YB.nextDouble()*MB.MC,rotationRate:JC(0.15,0.35)));g.v(new BB(tB*MB.tC(xD+pC*j),tB*MB.NC(xD+pC*j)));var rC=JC(0.2,0.5);g.v(new cB.FL(LC,LC.scale/AB));g.v(new LB(XE.value/i.CD));g.v(new wC("#333"));g.v(new RB(maxHealth:WB.iD/AB));g.v(new NB(p));g.v(new gC(10*rC,100*rC*DB.dG));if(p>10){g.v(new xC(JC(2,4).round().toInt()));}else{g.v(new mE());}g.hC();}sF(o,IB,m.dB,15*jB.sqrt(WE).toInt(),w);h.eD();}}}class nK extends EE{var XC;var kB;var XB;nK():super(VB.uB([mE,RB,t,NB,BB])); initialize(){super.initialize();XC=new u<RB>(RB,o);kB=new u<NB>(NB,o);XB=new u<BB>(BB,o);} oD( g){var j=XC.get(g);if(j.HC<=0){var i=GB.get(g);var h=kB.get(g);var k=XB.get(g);sF(o,i,h.dB,(jB.PI*h.dB*h.dB).toInt(),k);g.eD();}}}